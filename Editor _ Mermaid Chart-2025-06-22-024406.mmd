---
config:
  look: handDrawn
  theme: redux
---
graph TB
    START([Client Query])
    State[(Financial Planning State<br/>- Client profile<br/>- Financial goals<br/>- Risk tolerance<br/>- Timeline)]
    Input_Guard[Input Guardrails<br/>- Compliance check<br/>- Privacy validation<br/>- Regulatory requirements]
    Orchestrator{Orchestrator Agent<br/>- Query analysis<br/>- Route to specialists<br/>- Coordinate responses<br/>- Manage workflow}
    subgraph Specialists["üè¶ SPECIALIST FINANCIAL AGENTS"]
        Retirement_Agent{Retirement Planning Agent<br/>‚Ä¢ 401k/IRA optimization<br/>‚Ä¢ Social Security timing<br/>‚Ä¢ Pension analysis<br/>‚Ä¢ Withdrawal strategies}
        College_Agent{College Savings Agent<br/>‚Ä¢ 529 plan optimization<br/>‚Ä¢ Education cost projection<br/>‚Ä¢ Financial aid strategies<br/>‚Ä¢ Tax credit analysis}
        Investment_Agent{Advanced Investment Agent<br/>‚Ä¢ Portfolio optimization<br/>‚Ä¢ Asset allocation<br/>‚Ä¢ Alternative investments<br/>‚Ä¢ Risk management}
        Tax_Agent{Tax Planning Agent<br/>‚Ä¢ Tax-loss harvesting<br/>‚Ä¢ Roth conversions<br/>‚Ä¢ Tax-efficient strategies<br/>‚Ä¢ Municipal bonds analysis}
        Estate_Agent{Estate Planning Agent<br/>‚Ä¢ Inheritance planning<br/>‚Ä¢ Trust structures<br/>‚Ä¢ Gift tax strategies<br/>‚Ä¢ Legacy planning}
        Family_Agent{Family Trust Agent<br/>‚Ä¢ Trust administration<br/>‚Ä¢ Generation-skipping<br/>‚Ä¢ Family office strategies<br/>‚Ä¢ Wealth transfer}
    end
    subgraph Tools["üõ†Ô∏è SPECIALIZED TOOLS"]
        Retirement_Tools[Retirement Tools<br/>‚Ä¢ Monte Carlo simulations<br/>‚Ä¢ Social Security optimizer<br/>‚Ä¢ Required minimum distributions]
        College_Tools[Education Tools<br/>‚Ä¢ College cost calculator<br/>‚Ä¢ 529 plan analyzer<br/>‚Ä¢ Financial aid estimator]
        Investment_Tools[Investment Tools<br/>‚Ä¢ Portfolio analyzer<br/>‚Ä¢ Risk assessment<br/>‚Ä¢ Market data feeds]
        Tax_Tools[Tax Tools<br/>‚Ä¢ Tax calculator<br/>‚Ä¢ Bracket analysis<br/>‚Ä¢ Deduction optimizer]
        Estate_Tools[Estate Tools<br/>‚Ä¢ Estate tax calculator<br/>‚Ä¢ Trust analyzer<br/>‚Ä¢ Probate estimator]
        Family_Tools[Family Tools<br/>‚Ä¢ Trust management<br/>‚Ä¢ Generation planning<br/>‚Ä¢ Wealth transfer models]
    end
    Synthesis_Agent{Synthesis Agent<br/>- Integrate all recommendations<br/>- Resolve conflicts<br/>- Prioritize strategies<br/>- Create holistic plan}
    Compliance_Agent{Compliance Agent<br/>- Fiduciary duty check<br/>- Regulatory compliance<br/>- Risk disclosure<br/>- Documentation}
    Output_Guard[Output Guardrails<br/>- Final compliance check<br/>- Clear communication<br/>- Action items<br/>- Follow-up scheduling]
    END([Comprehensive Financial Plan])
    START --> State
    State --> Input_Guard
    Input_Guard --> Orchestrator
    Orchestrator --> Retirement_Agent
    Orchestrator --> College_Agent
    Orchestrator --> Investment_Agent
    Orchestrator --> Tax_Agent
    Orchestrator --> Estate_Agent
    Orchestrator --> Family_Agent
    Retirement_Agent -.-> Retirement_Tools
    College_Agent -.-> College_Tools
    Investment_Agent -.-> Investment_Tools
    Tax_Agent -.-> Tax_Tools
    Estate_Agent -.-> Estate_Tools
    Family_Agent -.-> Family_Tools
    Retirement_Agent --> Synthesis_Agent
    College_Agent --> Synthesis_Agent
    Investment_Agent --> Synthesis_Agent
    Tax_Agent --> Synthesis_Agent
    Estate_Agent --> Synthesis_Agent
    Family_Agent --> Synthesis_Agent
    Synthesis_Agent --> Compliance_Agent
    Compliance_Agent --> Output_Guard
    Output_Guard --> END
    Synthesis_Agent -.->|needs clarification| Orchestrator
    Compliance_Agent -.->|needs revision| Synthesis_Agent
    classDef orchestratorClass fill:#e1f5fe,stroke:#01579b,stroke-width:3px
    classDef specialistClass fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    classDef synthesisClass fill:#e8f5e8,stroke:#1b5e20,stroke-width:2px
    classDef toolClass fill:#fff3e0,stroke:#e65100,stroke-width:1px
    classDef guardClass fill:#fce4ec,stroke:#880e4f,stroke-width:2px
    classDef stateClass fill:#f1f8e9,stroke:#388e3c,stroke-width:2px
    class Orchestrator orchestratorClass
    class Retirement_Agent,College_Agent,Investment_Agent,Tax_Agent,Estate_Agent,Family_Agent specialistClass
    class Synthesis_Agent,Compliance_Agent synthesisClass
    class Retirement_Tools,College_Tools,Investment_Tools,Tax_Tools,Estate_Tools,Family_Tools toolClass
    class Input_Guard,Output_Guard guardClass
    class State stateClass
